\chapter{\IfLanguageName{dutch}{Proof of Concept}{Proof of Concept}}%
\label{ch:PoC}

Dit deel van het onderzoek presenteert een proof of concept gericht op welk framework er gebruik zal worden om machine learning pipelines lokaal uit te voeren, dat gebruikt kan worden in de cursus ``Machine Learning Operations''.
Het doel van deze proof of concept is de efficiÃ«ntie en bruikbaarheid van deze frameworks te onderzoeken aan de hand van een lokale opstelling met de gekozen frameworks. Hierbij zal de uitvoering van het framework alsook de resultaten en bevindingen hiervan besproken worden.
Hierna wordt, er aan de hand van de resulaten een conclusie genomen over het gekozen framework.
\section{Vereisten}
Vooraleer dat er gestart kan worden met het uitwerken van de volgende Proof of Concepts zijn er bepaalde vereisten nodig.
De vereisten zijn als volgt:
\begin{itemize}
    \item Python moet geinstalleerd zijn.
    \item De package manager ``pip''
\end{itemize}
Deze vereisten zorgen ervoor dat de volgende hoofdstukken zonder problemen werken.
\section{Ontwikkeling van de Machine Learning pipeline}
In dit onderdeel wordt de opbouw van de Machine Learning pipeline besproken, dit zal er voor zorgen dat het duidelijk is hoe de pipeline in elkaar zit.
De Machine Learning pipeline dat gebruikt gaat worden is die van Labo 3 van de cursus ``Machine Learning Operations''. Deze pipeline is ontworpen om aan de hand van Image Classification het verschil te kunnen herkennen tussen fotos van ``Appelsienen'' en ``Appels'', zoals besproken in de stand van zaken heeft deze pipeline verschillende onderdelen:

\begin{itemize}
    \item Preprocessing
    \item Training
    \item Evaluatie
\end{itemize}

De volgende hoofdstukken zullen elk van deze onderdelen toelichten en de werking ervan uitleggen, zoals weergegeven in diagram 1.4.2.
\subsection*{Packages}
Dit deel zal alle gebruikte packages kort uitleggen en hoe dat deze geinstelleerd kunnen worden. De packages zijn grotendeels het zelfde voor elke Proof of Concept maar kunnen extra pakcages hebben in verband met het gekozen framework.

De basis packages dat gebruikt zullen worden in de Proof of Concepts zijn:
\begin{itemize}
    \item Tensorflow: Voor het trainen en evalueren van het model, Tensorflow werkt samen met Keras hiervoor.
    \item os: Voor het maken van mappen voor de verschillende datasets die worden gebruikt tijdens de training en de evaluatie van het model.
    \item Requests: Voor het maken van HTTP-verzoeken naar de links van de afbeeldingen om deze dan te kunnen downloaden.
    \item Keras: Voor het maken van het model doormiddel van verschillende lagen.
    \item MLFlow: Voor het bijhouden van alle resultaten van het model, trainingsprocess en de evaluatie.
\end{itemize}

In de bijlage van deze Proof of Concept zal er een bestand zijn genaamd ``requirements\_framework.txt'' worden toegevoegd, waarbij ``framework'' de naam is van het gebruikte framework. Dit bestand kan samen met ``pip'' gebruikt worden om alle packages te installeren met het volgende commando:

\begin{minted}[frame=lines,breaklines,linenos]{bash}
    pip install -r "requirements.txt"
\end{minted}

\subsection{Preprocessing}
Het Preprocessing gedeelte van de pipeline gaat de data voorbereiden zodat het trainen van het model. Dit omvat het het laden en transformeren van de afbeeldingen, zodat deze afbeeldingen gebruikt kunnen worden als invoer voor het trainen van het model. In dit Proof of Concept wordt er gebruikt gemaakt van Tensorflow's ImageDataGenerator om afbeeldingen in te laden, te normalizeren en te voorzien van labels gebaseerd op de mapstructuur. Na het inladen van de afbeeldingen en deze klaar te maken voor het trainen van het model worden de afbeeldingen gesplits in trainings-, validatie- en testsets. In elke van deze sets worden de juiste labels voorzien. figuur x.x toont aan hoe het er voor deze Proof of Concept eruit zal zien. 
\subsection{Training}
Het Training gedeelte is gaat weldegelijk een Machine Learning-model trainen. Deze Proof of Concept zal gebruik maken van een Convolutional Neural Network (CNN) met behulp van Keras. Dit model bevat verschillende lagen en parameters.
Er word gebruik gemaakt keras sequential model, dit betekend dat alle lagen worden achtereenvolgens worden uitgevoerd. De volgorde en de lagen die gebruikt worden voor dit Proof of Concept zijn als volgend:
\begin{itemize}
    \item Convolutionele laag (Conv2D)
    \item Activatielaag (Activation)
    \item Flatten-laag
    \item Dense-laag
\end{itemize}
\subsection{Evaluatie}
Het evaluatie gedeelte zal het model evalueren dat we hiervoor hebben getraint. 

\section*{MLflow}
Elk van deze Proof of Concepts bevat MLflow zoals besproken in heeft dit framework heel wat functionaliteiten, voor deze Proof of Concepts gaan we vooral de parameters van het model, de resultaten van de training en de resultaten van de evaluatie bijhouden.
Dit noemt Experiment Tracking, en stelt ons in staat om experimenten bij te houden.

Om van MLflow gebruikt te kunnen maken moeten we het eerst importeren hieronder is een codevoorbeeld hoe dit gebeurd:

Nadata MLflow geimporteerd is, moeten we alle variablen veranderen zodat deze de resulaten naar de juiste server worden gestuurd en de juiste resulaten worden bijgehouden.
De varaiablen die we moeten bijhouden zijn als volgt:
\begin{minted}[frame=lines,breaklines, linenos]{python}
    import mlflow
    import mlflow.keras
\end{minted}

\begin{itemize}
    \item Parameter Logging: Het commando hiervoor is ``mflow().log\_param''. Dit houdts alle parameters bij van het model, zoals het aantal epochs of de batchgrootte.
    \item Metric Logging: Tijdens het trainen van het model zal MLflow belangerijke resulaten bijhouden, zoals de nauwkeurigheid en het verlies van het model. Dit word aan de hand van ``mlflow.log\_metric()'' bijgehouden. Deze metrics worden voor elke epoch van het trainingsproces bijgehouden om het verloop van de training te analyseren.
    \item 
\end{itemize}

\section*{Virtuele omgeving}
De volgende hoodstukken zullen gebruik maken van verschillende frameworks, deze frameworks hebben allemaal de mogelijkheid om lokaal een Machine Learning pipeline uit te voeren en deze frameworks voldoen ook aan alle nodige criteria van het requirementsanalyse.
\section*{Prefect}
Dit deel zal het Proof of Concept uitleggen waarbij Prefect word gebruikt samen met MLFlow voor het lokaal uitvoeren van Machine Learning pipelines, hierbij worden alle aanpassingen uitgelegd in de code van het framework vergeleken met de orignele code van Labo 3 van de cursus ``Machine Learning Operations''
\subsection*{Installatie}
De installatie van Prefect gebruikt met de package manager ``pip''. Via de terminal kan je met het volgende commando Prefect installeren, dit zal alle nodige libraries installeren.
\begin{minted}[frame=lines,breaklines,linenos]{bash}
    pip install -r "requirements.txt"
\end{minted}
\subsection*{Lokale Server}
Prefect heeft de mogelijkheid om Machine Learning pipelines lokaal uit te voeren, dit is aan de hand van een lokale server. 

\section*{ZenML}

\section*{Dagster}



